using System;
using System.Threading.Tasks;
using System.Web.Mvc;
using Azure.Identity;
using Azure.Security.KeyVault.Secrets;

public class SecretController : Controller
{
    public async Task<ActionResult> ShowSecret()
    {
        try
        {
            // Create a Key Vault Secret Client
            var secretClient = new SecretClient(new Uri("https://your-keyvault-name.vault.azure.net/"), new DefaultAzureCredential());

            // Specify the name of the secret you want to retrieve
            string secretName = "YourSecretName";

            // Retrieve the secret from Azure Key Vault
            KeyVaultSecret secret = await secretClient.GetSecretAsync(secretName);

            // Pass the secret value to the view
            ViewBag.SecretValue = secret.Value;

            return View();
        }
        catch (Exception ex)
        {
            // Handle errors, e.g., secret retrieval failure
            ViewBag.ErrorMessage = ex.Message;
            return View("Error");
        }
    }
}






@if (ViewBag.ErrorMessage != null)
{
    <p>Error: @ViewBag.ErrorMessage</p>
}
else
{
    <p>Secret Value: @ViewBag.SecretValue</p>
}
