      function DeleteOldBackups($backupFolder) {
        $backups = Get-ChildItem -Path $backupFolder | Where-Object { $_.PSIsContainer }
        $backups | Sort-Object LastWriteTime -Descending | Select-Object -Skip 5 | ForEach-Object {
          Write-Host "Deleting old backup: $($_.Name)"
          Remove-Item -Path $_.FullName -Recurse -Force
        }
      }

      $dt = Get-Date
      $fullstamp = $dt.ToString("yyyy-MM-dd HH-mm-ss")
      Write-Host "fullstamp: $fullstamp"

      $webBackupFolder = "C:\inetpub\wwwroot\backupFolder\backupsWeb\$fullstamp"
      $qaBackupFolder = "C:\inetpub\wwwroot\backupFolder\backupsQA\$fullstamp"
      $prodBackupFolder = "C:\inetpub\wwwroot\backupFolder\backupsProd\$fullstamp"

      New-Item -ItemType Directory -Path $webBackupFolder -Force
      New-Item -ItemType Directory -Path $qaBackupFolder -Force
      New-Item -ItemType Directory -Path $prodBackupFolder -Force

      Copy-Item -Path "C:\inetpub\wwwroot\demoweb\*" -Destination $webBackupFolder -Recurse
      Copy-Item -Path "C:\inetpub\wwwroot\demoA\*" -Destination $qaBackupFolder -Recurse
      Copy-Item -Path "C:\inetpub\wwwroot\demoProd\*" -Destination $prodBackupFolder -Recurse

      DeleteOldBackups "C:\inetpub\wwwroot\backupFolder\backupsWeb"
      DeleteOldBackups "C:\inetpub\wwwroot\backupFolder\backupsQA"
      DeleteOldBackups "C:\inetpub\wwwroot\backupFolder\backupsProd"
