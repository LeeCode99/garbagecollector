@echo off

set "parent_folder=C:\path\to\your\parent\folder"
set "folder_limit=5"

REM Get the number of folders in the parent folder
for /f %%i in ('dir /ad /b "%parent_folder%" ^| find /c /v ""') do set "folder_count=%%i"

REM Calculate the number of folders to delete
set /a "folders_to_delete=folder_count - folder_limit"

REM If there are more folders than the limit, delete the excess folders
if %folders_to_delete% gtr 0 (
    for /f "skip=%folders_to_delete% delims=" %%f in ('dir /ad /b /o-d "%parent_folder%"') do (
        echo Deleting folder "%%f"
        rd /s /q "%parent_folder%\%%f"
    )
) else (
    echo No folders to delete.
)
